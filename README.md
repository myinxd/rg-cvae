# RG-CVAE: a radio galaxy morphology generator
This repo aims to construct a radio galaxy morphology generator by training a deep neural network based conditional variational autoencoder (CVAE), and simulate new samples by feeding normal distributed vectors into the decoder subnet. 

## Construction of the package
In summary, we provide classes for constructing the CVAE network, as well as some utilities for image preprocessing, network saving and restoration, and etc. The users can build their own network with mean squared error (MSE), or cross entropy (CE) loss functions as the training objective. Batch normalization and dropout techniques are also good spices. For detailed instruction and usage, please refer to the code files.

Notebooks are provided as demos for the users to construct their own CVAE networks, which are 
- [notebook-cvae-mnist](https://github.com/myinxd/rg-cvae/blob/master/demo-mnist/notebook-cvae-mnist.ipynb): Train a CVAE network for mnist hand-written digits simulation;
- [notebook-dnnae-mnist-gmm.ipynb](https://github.com/myinxd/rg-cvae/blob/master/demo-mnist/notebook-cvae-mnist-gen.ipynb): Generate new handwritten images .

## Requirements
Some python packages should be installed before applying the nets, which are listed as follows,
- [numpy](http://www.numpy.org/)
- [scipy](https://www.scipy.org/)
- [astropy](https://www.astropy.org/)
- [matplotlib](http://www.matplotlib.org/)
- [tensorflow-gpu](http://www.tensorflow.org/)
- [scikit-learn](http://scikit-learn.org/)

Also, [CUDA](http://develop.nvidia.org/cuda) is required if you want to run the codes by GPU, a Chinese guide for CUDA installation on Ubuntu 16.04 is [here](http://www.mazhixian.me/2017/12/13/Install-tensorflow-with-gpu-library-CUDA-on-Ubuntu-16-04-x64/).

## Usage
Before constructing a CVAE net, the package should be installed. Here is the installation steps,
```sh
$ cd rg-cvae
$ pip3 install --user .
```
You may use `-e` for editable.

Detailed usage of our rg-cvae package is demonstrated in [demo-mnist](https://github.com/myinxd/rg-cvae/blob/master/demo-mnist/) by jupyter notebooks. Below are examples of handwritten digits generated by the trained cvae for MNIST.

<center>
<img src="https://github.com/myinxd/rg-cvae/blob/master/demo-mnist/digit_sim.png?raw=true" height=500 width=500>
</center>

## Contributor
- Zhixian MA <`zx at mazhixian.me`>

## Citation
<TODO>

## License
Unless otherwise declared:

- Codes developed are distributed under the [MIT license](https://opensource.org/licenses/mit-license.php);
- Documentations and products generated are distributed under the [Creative Commons Attribution 3.0 license](https://creativecommons.org/licenses/by/3.0/us/deed.en_US);
- Third-party codes and products used are distributed under their own licenses.